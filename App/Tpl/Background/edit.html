<include file="Public:header" />
<link rel="stylesheet" href="__PUBLIC__/css/class.public.css" />
<script src="__PUBLIC__/js/addResume.js"></script>

<style>
    body{overflow-y:hidden; }
    #main_pic_prev{width: 120px;height: 120px;border: 1px dashed #d3d3d6;}
    .add_body_title{
        margin:15px auto 30px auto;
    }
    .form-horizontal .control-label{
        text-align: right;
    }
    .fileinput-button1{
        position: relative;
        overflow: hidden;
    }
    .note-codable{
        display: none;
        width: 100%;
        padding: 10px;
        margin-bottom: 0;
        font-family: Menlo,Monaco,monospace,sans-serif;
        font-size: 14px;
        color: #ccc;
        background-color: #222;
        border: 0;
        -webkit-border-radius: 0;
        -moz-border-radius: 0;
        border-radius: 0;
        box-shadow: none;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        -ms-box-sizing: border-box;
        box-sizing: border-box;
        resize: none;
    }
    .timerinput{
        width:120px; display:inline;height: 32px;background: #ffffff !important;
    }
    .resume_area{
        width: 100%;
        height: 100%;
        resize: none;
        outline: none;
        padding: 20px;
        border: none;
    }

    .btn{
        line-height: 21px;
    }
    .form-control, .single-line{
        left: 0 !important;
    }
    .deletebtn{
        margin-bottom: 10px;
    }
    .btnclosee{
        position: absolute;
        right: 30px;
        top:10px;
    }
    .submitfiles{
        padding-left: 15px;
    }
    .youzhi input{
        content: "";
        display: inline-block;
        width: 17px;
        height: 17px;
        margin-left: -20px;
        border: 1px solid #cccccc;
        border-radius: 3px;
        background-color: #fff;
    }

</style>
<script type="text/javascript" src="__PUBLIC__/js/PCASClass.js" ></script>
<link rel="stylesheet" href="__PUBLIC__/css/jquery.fileupload.css" type="text/css" />
<script>
    $(function(){
        $(".add_body").height(window.innerHeight-$("#add_body").offset().top-$("#tfoot_div").height()-40);
        $(window).resize(function(){
            $(".add_body").height(window.innerHeight-$("#add_body").offset().top-$("#tfoot_div").height()-40);
        })
    })
</script>
<!--职位类别start-->
<div class="sPopupDiv none" id="jobdiv" style="float:left;"></div>
<!--职位类别end-->
<div class="wrapper wrapper-content animated fadeIn col-md-12">
    <form class="form-horizontal" id="form" role="form" action="{:U('background/add')}" method="post" enctype="multipart/form-data" autocomplete="off">
        <input type='hidden' name="r" <present name="r">value="{$r}"</present>/>
        <input type='hidden' name="module" <present name="r">value="{$module}"</present>/>
        <input type='hidden' name="id" <present name="r">value="{$model_id}"</present>/>
        <input type='hidden' name="eid" value="{:I('id')}"/>
        <div class="ibox-content add_body" id="add_body">
            <div class="row full-height-scroll">
                <div class="col-md-12 add_body" >
                    <div class="">
                        <div class="row" >
                            <div class="col-md-8 add_body_title">
                                <div class="all-inline">
                                    <span class="sq-tag"></span>
                                    <div class="text-tag">
                                        <span id="sid" data-id="{$id}">员工信息</span>
                                    </div>
                                </div>
                            </div>
                            <div  id="resume-search-form" class="col-md-8 add_body_form" style="margin-left:15px;">
                                <input type="hidden" name="url" />
                                <div class="form-group">
                                    <label class="col-md-3 control-label">姓名：</label>
                                    <div class="col-md-6">
                                        <input class="form-control required" type="text" id="name" name="name" value="{$data[s_name]}" maxlength="12">
                                        <span id="sketchTip"style="float: left;line-height: 32px;margin-left: 5%;color:red;"></span>
                                    </div>
                                    <div class="col-md-1"><span style="color: red;line-height: 32px;margin-left: 10px;">*</span></div>
                                </div>
                                <div  class="form-group">
                                    <label class="col-md-3 control-label">行业：</label>
                                    <div class="col-md-6">
                                        <input class="form-control required" type="text" id="industry" name="industry" value="{$data[industry]}" maxlength="20">
                                    </div>
                                    <div class="col-md-1"><span style="color: red;line-height: 32px;margin-left: 10px;">*</span></div>
                                </div>
                                <div  class="form-group">
                                    <label class="col-md-3 control-label">事业部：</label>
                                    <div class="col-md-6">
                                        <input class="form-control required" type="text" id="department" name="department" value="{$data['department']}" maxlength="20">
                                    </div>
                                    <div class="col-md-1"><span style="color: red;line-height: 32px;margin-left: 10px;">*</span></div>
                                </div>
                                <div  class="form-group">
                                    <label class="col-md-3 control-label">学校：</label>
                                    <div class="col-md-6">
                                        <input class="form-control required" type="text" id="school" name="school" value="{$data['school']}" maxlength="20">
                                    </div>
                                    <div class="col-md-1"><span style="color: red;line-height: 32px;margin-left: 10px;">*</span></div>
                                </div>
                                <div  class="form-group">
                                    <label class="col-md-3 control-label">专业：</label>
                                    <div class="col-md-6">
                                        <input class="form-control required" type="text" id="major" name="major" value="{$data['major']}" maxlength="20">
                                    </div>
                                    <div class="col-md-1"><span style="color: red;line-height: 32px;margin-left: 10px;">*</span></div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-3 control-label">学历：</label>
                                    <div class="col-md-6">
                                        <select class="form-control required" id="education" name="education" aria-required="true">

                                            <option value="专科"  <if condition="$data.education eq '专科'">selected</if>>专科</option>
                                            <option value="本科" <if condition="$data.education eq '本科'">selected</if>>本科</option>
                                            <option value="硕士" <if condition="$data.education  eq '硕士'">selected</if>>硕士</option>
                                            <option value="MBA/EMBA" <if condition="$data.education  eq 'MBA/EMBA'">selected</if>>MBA/EMBA</option>
                                            <option value="博士" <if condition="$data.education  eq '博士'">selected</if>>博士</option>
                                            <option value="博士后" <if condition="$data.education  eq '博士后'">selected</if>>博士后</option>
                                        </select>
                                        <span style="float: left;line-height: 32px;margin-left: 5%;color:red;"></span>
                                    </div>
                                    <div class="col-md-2"><span style="color: red;line-height: 32px;margin-left: 10px;">*</span></div>
                                </div>


                                <div class="form-group workExp">
                                    <label class="col-md-3 control-label">背调：</label>
                                    <div class="col-lg-9">
                                        <div class="panel panel-default bglist" style="padding-top: 20px;margin-right: 20px;margin-top: 10px;">
                                            <volist name="msglist" id="vo" key="k">
                                            <div style="background: none;border-bottom: 1px solid #ddd;padding-bottom: 10px;padding-top: 10px" class="panel-body3" data-id="{$vo['Id']}">
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">时间<span class="text-danger">*</span></label>
                                                    <div class="col-sm-9">
                                                        <input value="{$vo['enter_time']}" data-name="enter_time" class="form-control text-center timerinput required enter_time"  type="text" placeholder="年-月"   onFocus="WdatePicker({dateFmt:'yyyy-MM',maxDate:'2038-01-01'})" readonly="readonly" name="newenter_time{$k}" style="height: 32px;"><span>-&gt;</span>
                                                        <input value="{$vo['out_time']}" data-name="out_time" class="form-control text-center timerinput required out_time" id="workyearEnd" type="text" placeholder="年-月"    onFocus="WdatePicker({dateFmt:'yyyy-MM',maxDate:'2038-01-01'})"  readonly="readonly"  name="newout_time{$k}" style="height: 32px;">
                                                    </div>
                                                </div>
                                                <div class="form-group" >
                                                    <label class="col-sm-2 control-label">公司名称<span class="text-danger">*</span></label>
                                                    <div class="col-sm-9">
                                                        <input value="{$vo['company_name']}" data-name="company_name" class="form-control required company_name" type="text" id="companyName"  name="newcompany{$k}" maxlength="20"/>
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">职位<span class="text-danger">*</span></label>
                                                    <div class="col-sm-3">
                                                        <input value="{$vo['position']}" data-name="position" class="form-control required position" type="text"  name="newposition{$k}" maxlength="20">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">证明人姓名<span class="text-danger">*</span></label>
                                                    <div class="col-sm-3">
                                                        <input value="{$vo['witness']}" data-name="witness" class="form-control required witness" type="text"  name="newwitness{$k}" maxlength="20">
                                                    </div>
                                                    <label class="col-sm-2 control-label">与背调人关系<span class="text-danger"></span></label>
                                                    <div class="col-sm-4">
                                                        <input value="{$vo['witness_add']}" data-name="witness_add" class="form-control required witness_add" type="text" name="newrelationship{$k}" maxlength="20">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">联系人电话<span class="text-danger">*</span></label>
                                                    <div class="col-sm-3">
                                                        <input value="{$vo['tel']}" data-name="tel" class="form-control required tel" type="text" name="newtel{$k}" maxlength="20">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">联系人地址<span class="text-danger">*</span></label>
                                                    <div class="col-sm-3">
                                                        <input value="{$vo['adress']}" data-name="adress" class="form-control required adress" type="text" name="newaddress{$k}" maxlength="20">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-3 control-label">被调者在职期间工作情况：</label>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">工作表现<span class="text-danger">*</span></label>
                                                    <div class="col-sm-3">
                                                        <input value="{$vo['work_performance']}" data-name="work_performance" class="form-control required work_performance" type="text"  name="newperformance{$k}" maxlength="40">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">优缺点<span class="text-danger">*</span></label>
                                                    <div class="col-sm-3">
                                                        <input value="{$vo['bz']}" data-name="bz" class="form-control required bz" type="text" name="newyqd{$k}" maxlength="40">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">离职原因<span class="text-danger">*</span></label>
                                                    <div class="col-sm-3">
                                                        <input value="{$vo['reasons']}" data-name="reasons"  class="form-control required reasons" type="text" name="newreason{$k}" maxlength="40">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">健康状况和不良记录<span class="text-danger">*</span></label>
                                                    <div class="col-sm-3">
                                                        <input value="{$vo['health']}" data-name="health" class="form-control required health" type="text"  name="newrecord{$k}" maxlength="40">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">薪资<span class="text-danger">*</span></label>
                                                    <div class="col-sm-3">
                                                        <input value="{$vo['salary']}" data-name="salary" class="form-control required salary" type="text" id="jobPosition" name="newsalary{$k}" maxlength="20">
                                                    </div>
                                                </div>
                                                <button class="btn col-sm-offset-2 btn-danger btn-xs bddelete" style="margin-bottom: 10px" type="button" onclick="bgdelete(this)">删除</button>
                                            </div>
                                            </volist>
                                            <div class="panel-footer">
                                                <button class="btn btn-success btn-xs" type="button" onclick="bgadd()">增加新的背调</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <script>
                                    function del(data) {
                                        $(data).parent().remove();
                                    }
                                    var bgaddcount = 0;
                                    function bgadd() {
                                        var html ='';
                                        html ='<div style="background: none;border-bottom:1px solid #ddd;padding-bottom: 10px;padding-top:10px" class="panel-body3 bdmsg">' +
                                            '<div class="form-group">' +
                                            '<label class="col-sm-2 control-label">时间<span class="text-danger">*</span></label>' +
                                            '<div class="col-sm-9">' +
                                            '<input class="form-control text-center timerinput required enter_time" data-name="enter_time" id="workyearFrom"  type="text" placeholder="年-月"   onFocus="WdatePicker({dateFmt:&quot;yyyy-MM&quot;,maxDate:&quot;2038-01-01&quot;})" readonly="readonly" text-type="name" name="intime'+bgaddcount+'" style="height: 32px;">->' +
                                            '<input class="form-control text-center timerinput required out_time" data-name="out_time" id="workyearEnd" type="text" placeholder="年-月"    onFocus="WdatePicker({dateFmt:&quot;yyyy-MM&quot;,maxDate:&quot;2038-01-01&quot;})"  readonly="readonly" text-type="name" name="outtime'+bgaddcount+'" style="height: 32px;">' +
                                            '</div>' +
                                            '</div>' +
                                            '<div class="form-group" > <label class="col-sm-2 control-label">公司名称<span class="text-danger">*</span></label> <div class="col-sm-9"> <input class="form-control required company_name"  data-name="company_name" type="text" id="companyName" text-type="name" name="companyName'+bgaddcount+'" maxlength="30" /> </div> </div>' +
                                            '<div class="form-group"> <label class="col-sm-2 control-label">职位<span class="text-danger">*</span></label> <div class="col-sm-3"> <input class="form-control required position" data-name="position" type="text" id="jobPosition" text-type="name" name="jobPosition'+bgaddcount+'" maxlength="30" > </div> </div>'+
                                            '<div class="form-group"> <label class="col-sm-2 control-label">证明人姓名<span class="text-danger">*</span></label> <div class="col-sm-3"> <input class="form-control required witness" data-name="witness" type="text" text-type="name"  name="witness'+bgaddcount+'" maxlength="12" > </div> <label class="col-sm-2 control-label ">与背调人关系<span class="text-danger" style="position:relative;left:10px;top:-17px">*</span></label> <div class="col-sm-4"> <input class="form-control witness_add required" data-name="witness_add" type="text" id="depart" text-type="name" name="guanxi'+bgaddcount+'"> </div> </div>'+
                                            '<div class="form-group"> <label class="col-sm-2 control-label">联系人电话<span class="text-danger">*</span></label> <div class="col-sm-3"> <input class="form-control required tel" data-name="tel" type="text" text-type="name" name="tel'+bgaddcount+'" maxlength="11" > </div> </div>'+
                                            '<div class="form-group"> <label class="col-sm-2 control-label">联系人地址<span class="text-danger">*</span></label> <div class="col-sm-9"> <input class="form-control required adress" data-name="adress" type="text" text-type="name" name="address'+bgaddcount+'" maxlength="50" > </div> </div>'+
                                            '<div class="form-group"> <label class="col-sm-3 control-label">背调者在职期间工作情况：</label> </div>'+
                                            '<div class="form-group"> <label class="col-sm-2 control-label">工作表现<span class="text-danger">*</span></label> <div class="col-sm-3"> <input class="form-control required work_performance" data-name="work_performance" type="text" text-type="name"  name="performance'+bgaddcount+'" maxlength="30" > </div> </div>'+
                                            '<div class="form-group"> <label class="col-sm-2 control-label">优缺点<span class="text-danger">*</span></label> <div class="col-sm-3"> <input class="form-control required bz" data-name="bz" type="text" text-type="name" name="yqd'+bgaddcount+'" maxlength="30" > </div> </div>'+
                                            '<div class="form-group"> <label class="col-sm-2 control-label">离职原因<span class="text-danger">*</span></label> <div class="col-sm-3"> <input class="form-control required reasons" data-name="reasons" text-type="name" type="text" name="reason'+bgaddcount+'" maxlength="30" > </div> </div>'+
                                            '<div class="form-group"> <label class="col-sm-2 control-label">健康状况和不良记录<span class="text-danger">*</span></label> <div class="col-sm-3"> <input class="form-control required health" data-name="health" text-type="name" type="text" name="jl'+bgaddcount+'" maxlength="30" > </div> </div>'+
                                            '<div class="form-group"> <label class="col-sm-2 control-label">薪资<span class="text-danger">*</span></label> <div class="col-sm-3"> <input class="form-control required salary" data-name="salary" type="text" text-type="name" name="xz'+bgaddcount+'" maxlength="30" > </div> </div>'+
                                            '<button class="btn col-sm-offset-2 btn-danger btn-xs del" onclick="del(this)" type="button">删除</button>'+
                                            '</div>';
                                        $(".panel-footer").before(html);
                                        bgaddcount++;
                                    }
                                    function bgdelete(data){
                                        var id = $(data).parent().attr("data-id");
                                        if(!id){
                                            $(data).parent().remove();
                                        }else{
                                            var datas = {"id":id,"type":"bgmsg"};
                                            $.ajax({
                                                url:'/index.php?m=background&a=delete',
                                                data:datas,
                                                type:'post',
                                                dataType:'json',
                                                async:true,
                                                success:function (success) {
                                                    if(success['status']>0){
                                                        $(data).parent().remove();
                                                        alert_crm("删除成功！");
                                                    }else{
                                                        alert_crm("删除失败！")
                                                    }
                                                },
                                                error:function (error) {
                                                    alert_crm("删除失败！error:"+error);
                                                }
                                                
                                            })
                                        }
                                    }
                                </script>
                                <volist name="field_list['data']" id="vo" key="key">
                                    <div class="form-group"  style="display: none;">
                                        <label class="col-md-4 control-label">{$vo.name}：</label>
                                        <if condition="$vo['form_type'] == 'textarea'">
                                            <if condition = "$vo['tip_start'] eq 1">
                                                <div class="col-md-6">
                                                    <textarea class="form-control" id="description" name="description" rows="5"></textarea>
                                                </div>
                                                <div class="col-md-2"><span style="color: red;line-height: 32px;margin-left: 10px;">*</span></div>
                                                <else/>
                                                <div class="col-md-8">
                                                    <textarea class="form-control" id="description" name="description" rows="5"></textarea>
                                                </div>
                                            </if>
                                            <elseif condition="$vo['form_type'] == 'address'"/>
                                            <if condition = "$vo['tip_start'] eq 1">
                                                <div class="col-md-7">
                                                    {$vo.html}
                                                </div>
                                                <div class="col-md-1"><span style="color: red;line-height: 32px;margin-left: 10px;">*</span></div>
                                                <else/>
                                                <div class="col-md-8">
                                                    {$vo.html}
                                                </div>
                                            </if>
                                            <else/>
                                            <div class="col-md-6">
                                                {$vo.html}
                                            </div>
                                            <if condition = "$vo['tip_start'] eq 1 || $vo['field'] eq 'customer_id'">
                                                <div class="col-md-2"><span style="color: red;line-height: 32px;margin-left: 10px;">*</span></div>
                                                <else/>
                                                <div class="col-md-2"></div>
                                            </if>
                                        </if>
                                    </div>
                                </volist>
                            </div>
                            <div class="col-md-1 pull-right">
                                <!-- <div style="height: 100%; border-right: 1px dashed gray;">&nbsp;sadf</div> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="tfoot_div" class="clearfix">
            <div class="clearfix" id="tfoot_page">
                <div class="ibox-content" style="border-top: none;">
                    <div class="col-sm-offset-2" style="text-align:center;margin-left:0px;">
                        <button type="submit" id="bgsave"  class="btn btn-primary">保存</button>
                        <input class="btn btn-default" type="button" onclick="window.location='/index.php?m=background&a=index'" value="{:L('RETURN')}"/>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<div class="" style="display:none;" id="dialog-validate" title="{:L('TEST_RESULTS')}">
    {:L('HAVE_THE_FOLLOWING_PRODUCTS_ARE_SIMILAR_TO_THE_PRODUCT_NAME')}
    <div id="search_content"></div>
</div>
<div style="display:none;"  id="dialog-resume" title="粘贴简历">
    <div class="form-group">
        <label class="col-sm-1 control-label ng-binding">文件名称</label>
        <div class="col-sm-11">
            <input class="form-control ng-pristine ng-untouched ng-valid" type="text">
        </div>
        <div class="col-sm-12">
            <textarea class="msd-elastic form-control parse-content" style="margin-top: 10px;height: 280px;width: 100%;outline: none;resize: none; overflow: hidden; word-wrap: break-word;"></textarea>
        </div>
    </div>
</div>
<div class="" style="display:none;" id="dialog-business" title="选择项目">
    <div class="spiner-example">
        <div class="sk-spinner sk-spinner-three-bounce">
            <div class="sk-bounce1"></div>
            <div class="sk-bounce2"></div>
            <div class="sk-bounce3"></div>
        </div>
    </div>
</div>
<link href="__PUBLIC__/css/selector.css" rel="stylesheet" />
<script type="text/javascript" src="__PUBLIC__/js/uploadPreview.js"></script>
<script src="__PUBLIC__/js/citydata.js"></script>
<script src="__PUBLIC__/js/cityselector_o.js"></script>

<script type="text/javascript">


    //    lieselect();
    //初始化上传图片
    $("body").on('click','input[type="file"]', function(){
//	var selector = $(this).attr('id');
//	$("#"+selector).uploadPreview({ Img: selector+"_prev", Width: 120, Height: 120 });
    });
    $(document).ready(function(){
        $('#bgsave').off().on("click",function(){
            var goon = isNull();
            if(goon==0){
                var id = $('#sid').attr("data-id");
                var name = $("#name").val().trim();
                var industry = $("#industry").val().trim();
                var department = $("#department").val().trim();
                var school = $("#school").val().trim();
                var major = $("#major").val().trim();
                var education = $("#education").val().trim();
                var data = {"s_name":name,"industry":industry,"department":department,"school":school,"major":major,"education":education};
                var bgmsgs = new Array();
                $(".panel-body3").each(function () {
                    var bgmsg ={};
                    $(this).children("div").each(function () {
                        $(this).children("div").children("input").each(function () {
                            if($(this).val()) {
                                bgmsg[$(this).attr("data-name")] = $(this).val().trim();
                            }else{
                                return false;
                                alert_crm("请输入完整信息！");
                            }
                        })
                    });
                    if(JSON.stringify(bgmsg) != "{}"){
                        if($(this).attr("data-id")){
                            bgmsg['id']=$(this).attr("data-id");
                            bgmsgs.push(bgmsg);
                        }else{
                            bgmsgs.push(bgmsg);
                        }
                    }else{
                        return false;
                    }
                });
                if(JSON.stringify(bgmsgs) != "{}"){
                    data.bgmsgs = bgmsgs;
                }
                $.ajax({
                    url:'/index.php?m=background&a=save&id='+id,
                    type:'post',
                    dataType:'json',
                    data:data,
                    success:function (success) {
                        if(success.status=='true'){
                            swal({
                                title:'修改成功',
                                text:'点击确定返回！',
                                type:"success",
                                confirmButtonText: "确定"
                            },function (isConfirm) {
                                if(isConfirm){
                                    window.location='/index.php?m=background&a=index';
                                }
                            });
                        }else{
                            alert_crm("没有修改任何信息！");
                        }
                    },
                    error:function () {
                        alert_crm("修改失败！");
                    }
                })
            }else{
                /*alert_crm("请输入完整信息！");*/
            }
        });
        $(document).on("click",".btnclosee",function (event) {
            var width=$("#right-sidebar-log").width();
            if($("#right-sidebar-log").css('right') == '0px'){
                $("#right-sidebar-log").animate({right:'-'+width+'px'}, 400);
            }
            $("#linetoggle").remove();
        })

        $(".jCitySelector").loadCitySelector();

        $('#save_submit').prop('disabled',false);
        /*form表单验证*/
        $("#form").validate({
            submitHandler:function(form){
            }
        });

        $("#uploadresume").on("change",function () {
            var dataform = new FormData();
            dataform.append("file",$('#uploadresume')[0].files[0]);
//            dataform.append("resume",$('#uploadresume')[0].files[0]);
//            dataform.append("secret_key","LR1snHUsXWzLHehzcZRbk9aENhZ0Nk0000047aff");

            $.ajax({
//                url:"https://api.youyun.com/v1/resume",
                url:"/index.php?m=parse&a=index",
                type:"post",
                data:dataform,
                processData:false,
                contentType:false,
                success:function(data){
                    console.log(data);
                    if(data){
//                        location = "/index.php?m=product&a=edit&id="+data;
                    }
//                    var content=JSON.parse(data);
//                    //内容解析显示在页面中
//                    $("#name").val(content.name);
//                    var sex=content.sex;
//                    if(sex=="女"){
//                        $("input[name=sex]").eq(1).prop("checked","checked");
//                    }
//                    $("#telphone").val(content.telphone);
//                    $("#birthday").val(content.birthday);
////                    $("#dqs").val(content.living);
//                    $("#email").val(content.email);
//                    $("#curSalary").val(content.wage_current);
//                    $("input[name=url]").val(content.url);
//                    $("input[data-selector=dqs]").attr("value",content.living);
//                    $("input[data-selector=industry]").attr("value",content.hy);
//                    $("input[data-selector=job_class]").attr("value",content.job_classid);
////                    $("#dqs").val(content.living);
////                    $("input[data-selector=dqs]").val(content.living);
////                    $("input[data-selector=wantdqs]").val(wantdqs);
//                    $("#wantdqs").val(content.wage_current);
////                    lieselect();
//                    var edu=content.edu;
//                    $("#education option").each(function () {
//                        if(edu==$(this).attr("value")){
//                            $(this).attr("selected",true);
//                        }
//                    })
//
//                    var worksdata = content.workExp;
//                    var edudata = content.eduExps;
//                    var prodata = content.proExp;
//                    if(worksdata){
//                        $(".workExp .panel-body3").remove();
//                        $.each(worksdata,function(i,v){
//                            addWork(v);
//                        });
//                    }
//
//                    if(edudata){
//                        $(".eduExp .addedu").hide();
//                        $.each(edudata,function(i,v){
//                            addEdu(v);
//                        });
//                        $("#degree option").each(function () {
//                            if($(this).parent().attr("data-value")==$(this).val()){
//                                $(this).attr("selected","selected");
//                            }
//                        })
//                    }
//
//                    if(prodata){
//                        $(".projectExp .addpro").hide();
//                        $.each(prodata,function(i,v){
//                            addPro(v);
//                        });
//                    }

                    //出现右边的滑框
//                    if($("#right-sidebar-log").css('right') != '0px'){
//                        $("#right-sidebar-log").animate({right:'0px'}, 600);
//                        $("#right-sidebar-log").css("width","60%");
//                    }
//                    $('#sidebar-container').html("<div class='btn btn-primary btnclosee'>关闭</div><textarea class='resume_area'>"+content.content+"</textarea>");
//                    if($("#linetoggle").length>0){
//                        return
//                    }else{
//                        $('#sidebar-container').before("<div id='linetoggle'><div class='btn_ico'></div></div>");
//                    }
                },
                error:function(e){
                    alert("错误！！");
//                    window.clearInterval(timer);
                }
            });
        })
    });

    $(function () {
        $(document).on('click','.textdialog',function () {
            $('#dialog-resume').dialog('open');
        });

        $('#business_name').click(function () {
            $('#dialog-business').dialog('open');
            $('#dialog-business').load("{:U('business/listdialog')}");
        });
    })

    $("#dialog-business").dialog({
        autoOpen: false,
        modal: true,
        width: 800,
        height: 400,
        close: function () {
            $(this).html("");
        },
        buttons: {
            "{:L('OK')}": function () {
                var item = $('input:radio[name="business"]:checked').val();
                var name = $('input:radio[name="business"]:checked').parent().next().html();
                if(item){
                    $('#business_id').val(item);
                    $('#business_name').val(name);
                }
                $(this).dialog("close");
            },
            "{:L('CANCEL')}": function () {
                $(this).dialog("close");
            }
        },
        position:["center",100]
    });

    $("#dialog-resume").dialog({
        autoOpen: false,
        modal: true,
        width: 1100,
        maxHeight: 500,
        buttons: {
            "确定": function () {

                $.ajax({
                    type:"post",
                    url:"{:U('parse/parse_action')}",
                    data:{
                        content:$(".parse-content").val()
                    },
                    success:function(data){
                        var content=JSON.parse(data);
                        //内容解析显示在页面中
                        $("#name").val(content.name);
                        var sex=content.sex;
                        if(sex=="女"){
                            $("input[name=sex]").eq(1).prop("checked","checked");
                        }
                        $("#telphone").val(content.telphone);
                        $("#birthday").val(content.birthday);
                        $("input[name=url]").val(content.url);
//                    $("#dqs").val(content.living);
                        $("#email").val(content.email);
                        $("#curSalary").val(content.wage_current);
//                    $("#dqs").val(content.living);
                        $("input[data-selector=dqs]").attr("value",content.living);
                        $("input[data-selector=industry]").attr("value",content.hy);
                        $("input[data-selector=job_class]").attr("value",content.job_classid);
//                    $("input[data-selector=dqs]").attr("value",content.living);
//                    $("input[data-selector=wantdqs]").val(wantdqs);
//                        $("#wantdqs").val(content.wage_current);

                        var edu=content.edu;
                        $("#education option").each(function () {
                            if(edu==$(this).attr("value")){
                                $(this).attr("selected",true);
                            }
                        })
                        var worksdata = content.workExp;
                        var edudata = content.eduExps;
                        var prodata = content.proExp;
                        if(worksdata){
                            $(".workExp .panel-body3").remove();
                            $.each(worksdata,function(i,v){
                                addWork(v);
                            });
                        }

                        if(edudata){
                            $(".eduExp .addedu").hide();
                            $.each(edudata,function(i,v){
                                addEdu(v);
                            });
                        }

                        if(prodata){
                            $(".projectExp .addpro").hide();
                            $.each(prodata,function(i,v){
                                addPro(v);
                            });
                        }

                        //出现右边的滑框
//                        if($("#right-sidebar-log").css('right') != '0px'){
//                            $("#right-sidebar-log").animate({right:'0px'}, 600);
//                            $("#right-sidebar-log").css("width","60%");
//                        }
//                        $('#sidebar-container').html("<div class='btn btn-primary btnclosee'>关闭</div><textarea class='resume_area'>"+content.content+"</textarea>");
                        if($("#linetoggle").length>0){
                            return
                        }else{
                            $('#sidebar-container').before("<div id='linetoggle'><div class='btn_ico'></div></div>");
                        }
                    }
                })

                //追加产品信息
                $(".se_product_").each(function(){

                });
                $(this).dialog("close");
            },
            "取消": function () {
                $(this).dialog("close");
            }
        },
        position: ["center", 100],
        close:function(){
//            $(this).html('');
        }
    });



    $(function () {
        $("body").on("click",".deletebtn",function () {
            var item=$(this).closest(".panel").find(".panel-body3");
            if(item.length==1){
                item.closest(".col-lg-9").find(".adddefault").show();
                item.parent().remove();
            }
            $(this).closest(".panel-body3").remove();
        })
    })

</script>


<include file="Public:footer" />



<div id="right-sidebar-log">
    <!--the css for jquery.mCustomScrollbar-->
    <link rel="stylesheet" href="__PUBLIC__/emoji/css/jquery.mCustomScrollbar.min.css"/>
    <!--the css for this plugin-->
    <link rel="stylesheet" href="__PUBLIC__/emoji/css/jquery.emoji.css"/>
    <!--(Optional) the js for jquery.mCustomScrollbar's addon-->
    <script src="__PUBLIC__/emoji/js/jquery.mousewheel-3.0.6.min.js"></script>
    <!--the js for jquery.mCustomScrollbar-->
    <script src="__PUBLIC__/emoji/js/jquery.mCustomScrollbar.min.js"></script>
    <!--the js for this plugin-->
    <script src="__PUBLIC__/emoji/js/jquery.emoji.js"></script>

    <!--<div class="sidebar-container" id="sidebar-container">-->

    <!--</div>-->
</div>

<style>

    .sidebar-container ul.nav-tabs li a{
        background: #fff !important;
        color: #a7b1c2 !important;
        font-weight: 600 !important;
        padding: 14px 20px 14px !important;
        border-right: none !important;
    }
    .sidebar-container nav{
        display: none;
    }
    .sidebar-container #page-wrapper{
        margin-left: 0px;
    }
    #sidebar-container{
        box-shadow: rgb(187, 187, 187) -1px 10px 10px;
        border: 2px solid rgb(238, 238, 238);
    }

    #right-sidebar-log{
        width: 60%;
        right: -60%;
        background-color: #fff;
        position: fixed;
        top: 60px;
        z-index: 1009;
        bottom: 0;
        box-shadow: -5px -5px 1px #ccc;
    }

</style>
<script src="__PUBLIC__/resume_selector/common.21a64352.js"></script>
<script src="__PUBLIC__/resume_selector/resume.search.910ebde0.js "></script>